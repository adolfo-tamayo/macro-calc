<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body style="font-family: 'Roboto', sans-serif;">
        <div class="container" id="app">
            <div class="row">
                <div class="col-sm" id='myContainer' style="padding: 1em;">
                    <form id="calcform" v-on:submit="onSubmitForm">
                        <div class="form-group">
                            <label for="gender">Sexo:</label>
                            <select class="form-control" id="gender" v-model="gender">
                                <option value="m">Masculino</option>
                                <option value="f">Femenino</option>
                            </select>
                        </div>
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="age">Edad:</label>
                                    <input type="number" class="form-control" min="1" max="99" id="age" placeholder="Edad" required v-model="age">
                                    <!-- <small id="ageHelp" class="form-text text-muted">Tu edad nos ayuda a determinar tu consumo cal칩rico</small> -->
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="weight">Peso(kg):</label>
                                    <input type="number" class="form-control" min="1" id="weight" placeholder="Peso (kg)" required v-model="weight">
                                    <!-- <small id="ageHelp" class="form-text text-muted">Tu edad nos ayuda a determinar tu consumo cal칩rico</small> -->
                                </div>
                            </div>
                            <div class="col"> 
                                <div class="form-group">
                                    <label for="height">Altura(cm):</label>
                                    <input type="number" class="form-control" min="1" id="height" placeholder="Altura (cm)" required v-model="height">
                                    <!-- <small id="ageHelp" class="form-text text-muted">Tu edad nos ayuda a determinar tu consumo cal칩rico</small> -->
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="activitySelect">Nivel de actividad:</label>
                            <select class="form-control" id="activitySelect" v-model="activity">
                                <option value="1.2">Sedentario (Poco o nada de ejercicio)</option> 
                                <option value="1.375">Ligeramente Activo (Ejercicio ligero. 1-3 veces a la semana)</option>
                                <option value="1.55">Moderadamente Activo (Ejercicio moderado. 3-5 veces a la semana)</option>
                                <option value="1.725">Muy Activo (Ejercicio fuerte. 6-7 veces a la semana)</option>
                                <option value="1.9">Extra Activo (Ejercicio muy fuerte + Trabajo fisico diario)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="objective">Objetivo:</label>
                            <select class="form-control" id="objective" v-model="objective">
                                <option value="loose">Quemar grasa</option>
                                <option value="keep">Mantener resultados</option>
                                <option value="gain">Aumentar musculo</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">Ver mis resultados</button>
                    </form>
                    <div id="results"></div>
                </div>
            </div>
            <div v-if="hasSumbitted">
                <hr />
                <h5>Total de calorias: <b>{{intake}}</b></h5>
                <br>
                <h5>Macronutrientes:</h5>
                <ul style="list-style: none;">
                    <li>游볼 <b>Proteina: </b> {{protein}} gramos </li>
                    <li>游꼨 <b>Carbohidratos:</b> {{carbs}} gramos</li>
                    <li>游볨 <b>Grasas:</b> {{fats}} gramos</li>
                </ul>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/vue"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
        <script>
            // constants
            var men = {
                loose: -800,
                keep: -400,
                gain: 150,
            }
            var women = {
                loose: -550,
                keep: -300,
                gain: 200,
            }
            var fat_ratios = {
                loose: 0.3,
                keep: 0.3,
                gain: 0.2
            }
            var carb_ratios = {
                loose: 0.3,
                keep: 0.35,
                gain: 0.4
            }
            var protein_ratios = {
                loose: 0.4,
                keep: 0.35,
                gain: 0.4
            }

            // Vue app
            var app = new Vue({ 
                el: '#app',
                data: {
                    age: null,
                    height: null,
                    weight: null,
                    activity: "1.2",
                    objective: "loose",
                    gender: 'm',
                    hasSumbitted: false,
                    intake: 0,
                    protein: 0,
                    carbs: 0,
                    fats: 0,

                },
                methods: {
                    onSubmitForm: function(event){
                        event.preventDefault()
                        
                        age = Number(this.age)
                        height = Number(this.height)
                        weight = Number(this.weight)
                        activity = Number(this.activity)
                        
                        var gender_cals = this.gender == "m" ? 5 : -161;
                        var objective_cals = this.gender == "m" ? men[this.objective]: women[this.objective];

                        var calories = 10 * weight + 6.25 * height - 5 * age + gender_cals
                        var tdee = calories * activity
                        var intake = tdee + objective_cals
                        var protein = (protein_ratios[this.objective] * intake) / 4;
                        var carbs = (carb_ratios[this.objective] * intake) / 4;
                        var fats = (fat_ratios[this.objective] * intake) / 9;

                        calories = Math.round(calories)
                        tdee = Math.round(tdee)
                        this.intake = Math.round(intake)
                        this.protein = Math.round(protein)
                        this.carbs = Math.round(carbs)
                        this.fats = Math.round(fats)
                        this.hasSumbitted = true
                    }
                }
            });

        </script>
    </body>
</html>